/*! gulp-boilerplate v4.2.3 | (c) 2017 Chris Ferdinandi | MIT License | http://github.com/cferdinandi/Plugin */
!function(){"use strict";function e(e,r,s,t,o){function n(e){return angular.isObject(e)?e:{name:e}}function a(e){var r=e?u.songs.filter(i(e)):[];return console.log(r),r}function i(e){var r=angular.lowercase(e);return function(e){return console.log("SONG IS ",e),0===e._lowername.indexOf(r)||0===e._lowerartist.indexOf(r)}}function c(){console.log("TEST"),u.readonly=!1,u.selectedItem=null,u.searchText=null,u.querySearch=a,u.selectedSongs=[],u.numberChips=[],u.numberChips2=[],u.numberBuffer="",u.autocompleteDemoRequireMatch=!0,u.transformChip=n,console.log("LENGTH IS "+u.songs.length);var e=u.songs;return console.log(e,u.playlistSelected),e.map(function(e){return e._lowername=e.name.toLowerCase(),e._lowerartist=e.artist.toLowerCase(),e})}function l(){var r=s.defer();return e.get("/api/getUserPlaylists",{params:{user_id:t.get("user_id")}}).success(function(e){console.log(e);for(var s in e.items){var t={name:e.items[s].name,id:e.items[s].id};console.log(e.items[s].name),u.playlists.push(t)}r.resolve(e)}).error(function(e){r.reject(e),console.log("Error: "+e)}),r.promise}var u=this;if(console.log(o.url()),/access_token/.test(o.url())&&/refresh_token/.test(o.url())){u.authenticated=!0,u.playlists=[];var m=l();m.then(function(e){u.readonly=!1,u.selectedItem=null,u.searchText=null,u.querySearch=a,u.selectedSongs=[],u.numberChips=[],u.numberChips2=[],u.numberBuffer="",u.autocompleteDemoRequireMatch=!0,u.transformChip=n,u.accessToken="",u.refreshToken="",u.userId="",u.recommendations=[],u.songs=[],u.loggedIn=!0,u.playlistSelected=!1})}else u.loggedIn=!1;u.getMySavedTracks=function(){var r=s.defer();return e.get("/api/me/tracks").success(function(e){console.log(e),u.songs=[];for(var s in e.items){var t={name:e.items[s].track.name,artist:e.items[s].track.artists[0].name,id:e.items[s].track.id,artist_id:e.items[s].track.artists[0].id};u.songs.push(t)}c(),u.playlistSelected=!0,r.resolve(e)}).error(function(e){r.reject(e),console.log("Error: "+e)}),r.promise},u.getPlaylistsTracks=function(r){var o=s.defer();return e.get("/api/getPlaylistsTracks",{params:{user_id:t.get("user_id"),playlist_id:r.id}}).success(function(e){console.log(e),u.songs=[];for(var r in e.tracks.items){var s={name:e.tracks.items[r].track.name,artist:e.tracks.items[r].track.artists[0].name,id:e.tracks.items[r].track.id,artist_id:e.tracks.items[r].track.artists[0].id};u.songs.push(s)}c(),u.playlistSelected=!0,o.resolve(e)}).error(function(e){o.reject(e),console.log("Error: "+e)}),o.promise},u.getRecommendations=function(){var r=s.defer(),t=[],o=[];for(var n in u.selectedSongs)t.push(u.selectedSongs[n].artist_id),o.push(u.selectedSongs[n].id);return e.post("/api/getRecommendations",{params:{seed_artists:t,seed_tracks:o}}).success(function(e){console.log(e);for(var s in e.tracks){var t={song:e.tracks[s].name,artist:e.tracks[s].artists[0].name,uri:"https://embed.spotify.com/?uri="+e.tracks[s].uri};u.recommendations.push(t)}c(),u.playlistSelected=!0,r.resolve(e)}).error(function(e){r.reject(e),console.log("Error: "+e)}),r.promise}}angular.module("MyApp",["ngMaterial","ngCookies"]).controller("SpotifyController",e).filter("trusted",["$sce",function(e){return function(r){return e.trustAsResourceUrl(r)}}])}();